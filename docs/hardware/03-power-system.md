# 03 - 供电系统设计

> **供电是机器人的"血液循环"，设计不好会导致各种奇怪问题。**

---

## 🎯 设计目标

1. **稳定**：不因电压波动导致系统重启
2. **安全**：过流保护、短路保护
3. **续航**：满足日常使用需求
4. **可维护**：易于更换、充电

---

## 📊 功耗分析

### L2 阶段功耗预估

| 组件 | 电压 | 电流 | 功率 | 备注 |
|------|------|------|------|------|
| ITX 主机 | 12V/19V | 2-5A | 24-60W | 取决于负载 |
| STM32 | 5V | 50mA | 0.25W | 很低 |
| 电机×4 | 6-12V | 0.5A×4 | 12W | 满载 |
| L298N 驱动 | 12V | 2A | 24W | 峰值 |
| 舵机 SG90 | 5V | 0.5A | 2.5W | 峰值 |
| 超声波 | 5V | 15mA | 0.075W | 很低 |
| **总计** | - | - | **60-100W** | 峰值 |

### 典型工作场景

| 场景 | 功耗 | 说明 |
|------|------|------|
| 待机 | 30W | 主机空闲、电机停止 |
| 对话 | 40W | 主机运算、电机停止 |
| 移动 | 70W | 主机运算、电机运转 |
| 峰值 | 100W | 所有组件满载 |

---

## 🔋 供电方案

### 方案 A：分离供电（推荐）

```
┌─────────────────────────────────────────┐
│  AC 220V                                │
│     │                                   │
│     ├─→ [12V/5A 电源] → ITX 主机        │
│     │                                   │
│     └─→ [充电器] → 锂电池组 → 底盘系统  │
│                         │               │
│                    ┌────┴────┐          │
│                    ↓         ↓          │
│                 STM32    电机/舵机      │
└─────────────────────────────────────────┘
```

**优点**：
- ITX 主机供电稳定
- 底盘可以独立移动（短时间）
- 电池问题不影响主机

**缺点**：
- 需要两套供电
- 移动范围受限于电源线

**适用场景**：
- 室内固定区域活动
- 有充电桩的场景

---

### 方案 B：统一电池供电

```
┌─────────────────────────────────────────┐
│  [大容量锂电池组]                        │
│  24V 10Ah (240Wh)                       │
│         │                               │
│    ┌────┴────┬────────┐                 │
│    ↓         ↓        ↓                 │
│ [DC-DC]   [DC-DC]  [DC-DC]              │
│  12V/5A    5V/3A   直接12V              │
│    ↓         ↓        ↓                 │
│  ITX主机   STM32   电机驱动             │
└─────────────────────────────────────────┘
```

**优点**：
- 完全无线移动
- 系统简洁

**缺点**：
- 电池成本高
- 续航有限（约2-4小时）
- 需要定期充电

**适用场景**：
- 需要自由移动
- 有自动充电桩

---

### 方案 C：混合供电（当前方案）

```
┌─────────────────────────────────────────┐
│  [笔记本/台式机]  ←  AC 220V            │
│         │ USB                           │
│         ↓                               │
│  [STM32 + 底盘]  ←  18650×2 电池        │
└─────────────────────────────────────────┘
```

**优点**：
- 成本最低
- 快速验证

**缺点**：
- 上位机不能移动
- 受 USB 线长度限制

**适用场景**：
- 开发调试阶段
- 验证功能

---

## 🔌 电源模块选型

### 1. ITX 主机电源

| 类型 | 规格 | 价格 | 特点 |
|------|------|------|------|
| DC-ATX | 12V→ATX | ¥50-100 | 需要外部12V电源 |
| Pico PSU | 12V→ATX | ¥80-150 | 小巧、效率高 |
| 原装适配器 | 19V DC | ¥100-200 | 最稳定 |

**推荐**：使用主机原装适配器，最稳定。

### 2. 底盘电源

| 方案 | 规格 | 价格 | 续航 |
|------|------|------|------|
| 18650×2 | 7.4V 2000mAh | ¥30 | 1-2小时 |
| 18650×3 | 11.1V 2000mAh | ¥45 | 1-2小时 |
| 航模电池 | 11.1V 5000mAh | ¥150 | 3-5小时 |

### 3. 稳压模块

| 模块 | 输入 | 输出 | 电流 | 价格 |
|------|------|------|------|------|
| LM2596 | 4-40V | 1.5-35V | 3A | ¥5 |
| XL4015 | 8-36V | 1.25-32V | 5A | ¥10 |
| MP1584 | 4.5-28V | 0.8-20V | 3A | ¥3 |

---

## ⚡ 电源保护

### 必须有的保护

| 保护类型 | 实现方式 | 重要性 |
|----------|----------|--------|
| 过流保护 | 保险丝/电子保护 | ⭐⭐⭐⭐⭐ |
| 短路保护 | 保险丝 | ⭐⭐⭐⭐⭐ |
| 反接保护 | 二极管/MOS | ⭐⭐⭐⭐ |
| 过压保护 | TVS/稳压 | ⭐⭐⭐ |
| 欠压保护 | 电池管理板 | ⭐⭐⭐ |

### 推荐配置

```
电池 → [保险丝 5A] → [电池保护板] → [开关] → 负载
```

---

## 🔧 接线规范

### 线材选择

| 电流 | 线径 | 颜色规范 |
|------|------|----------|
| <1A | 0.5mm² | 红正黑负 |
| 1-3A | 1.0mm² | 红正黑负 |
| 3-5A | 1.5mm² | 红正黑负 |
| >5A | 2.5mm² | 红正黑负 |

### 接线注意事项

1. **所有正极用红色线**
2. **所有负极用黑色线**
3. **信号线用其他颜色**
4. **大电流线要足够粗**
5. **接头要牢固，避免虚焊**

---

## 📐 电源布局

```
┌─────────────────────────────────────┐
│  机器人底盘俯视图                    │
│                                     │
│  ┌─────┐          ┌─────┐          │
│  │电机1│          │电机2│          │
│  └─────┘          └─────┘          │
│                                     │
│       ┌─────────────────┐          │
│       │    电池仓        │          │
│       │  [18650×2]      │          │
│       └─────────────────┘          │
│                                     │
│  ┌─────┐  ┌─────┐  ┌─────┐        │
│  │L298N│  │STM32│  │开关 │        │
│  └─────┘  └─────┘  └─────┘        │
│                                     │
│  ┌─────┐          ┌─────┐          │
│  │电机3│          │电机4│          │
│  └─────┘          └─────┘          │
└─────────────────────────────────────┘
```

---

## ✅ 当前方案总结

### L2 阶段（当前）

```
[笔记本] ← AC 220V
    │ USB
    ↓
[STM32 + 底盘] ← 18650×2 (7.4V)
```

### L2 完善阶段（目标）

```
[ITX 主机] ← AC 220V (12V 适配器)
    │ USB
    ↓
[STM32 + 底盘] ← 18650×3 (11.1V)
```

### L3 阶段（未来）

```
[24V 锂电池组]
    │
    ├─→ DC-DC 12V → ITX 主机
    ├─→ DC-DC 5V → STM32
    └─→ 直接 → 电机驱动

+ 自动充电桩
```

---

## 🔗 相关文档

- [04-motion-system.md](./04-motion-system.md) - 运动系统
- [06-assembly-guide.md](./06-assembly-guide.md) - 装配指南
