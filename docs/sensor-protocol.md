# Simo 传感器协议

> **版本**: V1  
> **日期**: 2026-01-17  
> **原则**: 传感器只上报数据，不自主行动

## 硬件引脚

| 传感器 | 引脚 | 说明 |
|--------|------|------|
| 超声波 TRIG | PB15 | 触发信号 |
| 超声波 ECHO | PB14 | 回波信号 |
| 红外循迹 左 | PB13 | 0=黑线, 1=白底 |
| 红外循迹 右 | PB12 | 0=黑线, 1=白底 |

## 串口命令

### 读取超声波距离

```
DIST\n
```

响应：
```
DIST,123\n    // 距离 12.3cm (单位: 0.1cm)
```

### 读取红外循迹

```
IR\n
```

响应：
```
IR,L0R1\n     // 左=0(黑线), 右=1(白底)
```

### 读取所有传感器

```
SENSOR\n
```

响应：
```
SENSOR,D123,L0R1\n    // 距离12.3cm, 左0右1
```

## 行为约束

根据 BEHAVIOR.md：

1. **传感器只读不动** - 读取传感器不触发任何运动
2. **避障/循迹需人类确认** - 不能自主避障或循迹
3. **STOP 永远抢占** - 即使在读取传感器时

## 前端显示

- 超声波距离: 数字 + 进度条
- 红外循迹: 左右指示灯
- 刷新频率: 500ms（可调）

## 未来扩展（需人类确认）

- 避障模式: 检测到障碍物时**询问**是否停止
- 循迹模式: 检测到偏离时**询问**是否修正
